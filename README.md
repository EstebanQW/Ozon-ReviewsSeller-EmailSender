# Для чего этот скрипт

Этот скрипт предназначен для автоматического сбора отзывов о товарах с платформы Ozon (через личный кабинет селлера) и отправки их на указанный email.<br>
Скрипт предназначен для работы в паре с репозиторием (но можно использовать и отдельно) [Ozon-ReviewsSeller-EmailChecker](https://github.com/EstebanQW/Ozon-ReviewsSeller-EmailChecker.YCF) (сначала формируются письма с отзывами, отправляются на почту сотрудника (или проект для обработки отзывов), который их обрабатывает. Затем скрипт `Ozon-ReviewsSeller-EmailChecker` проверяет почту и отправляет ответы по API. Скрипт создавался, чтобы ослеживать среднее время ответа, количество обработанных отзывов)

___

# Начало работы

* [Структура письма](#структура-письма)  
* [Установка зависимостей](#установка-зависимостей)  
* [Настройка параметров](#настройка-параметров)  
* [Запуск скрипта](#запуск-скрипта)  
* [Как работает скрипт](#как-работает-скрипт)  
* [Пример использования](#пример-использования)  
* [Важные замечания](#важные-замечания)  
* [Пример вывода в консоль](#пример-вывода-в-консоль)  


## Структура письма

Скрипт формирует письмо для каждого отзыва, содержащее:

Текст отзыва.<br>
Ссылку на товар.<br>
Оценку клиента.<br>
Статус заказа.<br>
Название бренда.<br>
ID вопроса.<br>
Дату поступления вопроса.<br>
Артикул на Ozon.<br>
Артикул на вашем сайте.<br>
Название товара.<br>
![image](https://github.com/user-attachments/assets/7dd0683a-2af5-45e5-8145-93189197c27d)



## Установка зависимостей

Перед запуском скрипта убедитесь, что у вас установлены все необходимые библиотеки. Для этого выполните команду:
```
pip install requests
```

## Настройка параметров

В начале скрипта находятся переменные, которые необходимо настроить перед запуском:<br>
`company_id`: Уникальный идентификатор компании на Ozon. Его можно найти в URL страницы компании на Ozon. Например, для URL https://www.ozon.ru/seller/ooo-mebelnaya-fabrika-volzhanka-1234/products/?miniapp=seller_1234 идентификатор компании — 1234.<br>
`fromaddr`: Почта, с которой будет отправляться письмо.<br>
`mypass`: Пароль от почты для внешних приложений. Для почты mail.ru пароль можно получить по ссылке: https://account.mail.ru/user/2-step-auth/passwords.<br>
`toaddr`: Почта, на которую будут отправляться письма.<br>
`review_sum`: Количество запросов для получения отзывов. Один запрос возвращает до 10 отзывов.<br>
`cookie`: Актуальные куки для авторизации на платформе Ozon.<br>

## Запуск скрипта
После настройки параметров запустите скрипт:
```
python main.py
```

## Как работает скрипт

* Скрипт отправляет запросы к API Ozon для получения отзывов.
* Каждый запрос возвращает до 10 отзывов.
* Если запросы завершаются успешно, отзывы сохраняются в список.
* Письма отправляются на указанный email.
* Если скрипт не может получить отзывы (например, из-за ошибки авторизации), он завершает работу с сообщением об ошибке.
* Если отправка письма завершается ошибкой, скрипт делает до 2 попыток с задержкой в 2 секунды.


## Пример использования
Установите зависимости.<br>
Настройте параметры.<br>
Запустите скрипт.<br>
После завершения работы скрипта проверьте почту, на которую отправлялись письма.<br>

## Важные замечания
Убедитесь, что куки актуальны. Если куки истекли, скрипт не сможет получить отзывы.<br>
Скрипт делает паузы между запросами, чтобы избежать блокировки со стороны Ozon.<br>
Для работы с почтой mail.ru необходимо использовать пароль для внешних приложений, который можно получить по ссылке: https://account.mail.ru/user/2-step-auth/passwords.<br>

## Пример вывода в консоль
```
Отправляю запрос на сервер OZON для получения отзывов. Запрос 1 из 10.
review id = 12345
Сообщение отправлено. Осталось отправить: 9шт.
_____________________________________________

Отправляю запрос на сервер OZON для получения отзывов. Запрос 2 из 10.
review id = 67890
Сообщение отправлено. Осталось отправить: 8шт.
_____________________________________________
...
...
...
Все сообщения(кейсы) отправлены.
```
